"""
üü¢ BUBBLE SORT (–ü—É–∑—ã—Ä—å–∫–æ–≤–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)

–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:
- –õ—É—á—à–∏–π —Å–ª—É—á–∞–π: O(n) - –∫–æ–≥–¥–∞ –º–∞—Å—Å–∏–≤ —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
- –°—Ä–µ–¥–Ω–∏–π —Å–ª—É—á–∞–π: O(n¬≤)
- –•—É–¥—à–∏–π —Å–ª—É—á–∞–π: O(n¬≤) - –∫–æ–≥–¥–∞ –º–∞—Å—Å–∏–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ

–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: O(1) - in-place –∞–ª–≥–æ—Ä–∏—Ç–º

–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: –î–∞ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
"""


def bubble_sort(arr):
    """
    üü¢ Junior level
    –ü—É–∑—ã—Ä—å–∫–æ–≤–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ - –ø—Ä–æ—Å—Ç–µ–π—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    
    –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:
    1. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ–ø–∞—Ä–Ω–æ
    2. –ï—Å–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –º–µ–Ω—è–µ–º –∏—Ö –º–µ—Å—Ç–∞–º–∏
    3. –ü–æ–≤—Ç–æ—Ä—è–µ–º –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä –¥–æ –∫–æ–Ω—Ü–∞ –º–∞—Å—Å–∏–≤–∞
    4. –ü–æ–≤—Ç–æ—Ä—è–µ–º –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å, –ø–æ–∫–∞ –º–∞—Å—Å–∏–≤ –Ω–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è
    
    Args:
        arr: —Å–ø–∏—Å–æ–∫ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        
    Returns:
        –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
        
    >>> bubble_sort([64, 34, 25, 12, 22, 11, 90])
    [11, 12, 22, 25, 34, 64, 90]
    """
    arr = arr.copy()
    n = len(arr)
    
    # –í–Ω–µ—à–Ω–∏–π —Ü–∏–∫–ª - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ö–æ–¥–æ–≤
    for i in range(n):
        swapped = False
        
        # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ü–∏–∫–ª - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ—Å–µ–¥–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        # n - i - 1 –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ i —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–∂–µ –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö
        for j in range(0, n - i - 1):
            if arr[j] > arr[j + 1]:
                # –ú–µ–Ω—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ—Å—Ç–∞–º–∏
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
                swapped = True
        
        # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –æ–±–º–µ–Ω–æ–≤, –º–∞—Å—Å–∏–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
        if not swapped:
            break
    
    return arr


# ============================================================================
# –ü–û–®–ê–ì–û–í–û–ï –ò–°–ü–û–õ–ù–ï–ù–ò–ï
# ============================================================================

def bubble_sort_with_steps(arr):
    """
    –í–µ—Ä—Å–∏—è —Å –≤—ã–≤–æ–¥–æ–º –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
    """
    arr = arr.copy()
    n = len(arr)
    step = 0
    
    print(f"–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {arr}")
    print(f"–î–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞: {n}")
    print("=" * 50)
    
    for i in range(n):
        print(f"\n–ü—Ä–æ—Ö–æ–¥ {i + 1}:")
        swapped = False
        
        for j in range(0, n - i - 1):
            step += 1
            print(f"  –®–∞–≥ {step}: –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º arr[{j}]={arr[j]} –∏ arr[{j+1}]={arr[j+1]}")
            
            if arr[j] > arr[j + 1]:
                print(f"    {arr[j]} > {arr[j+1]}, –º–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏")
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
                print(f"    –ú–∞—Å—Å–∏–≤ –ø–æ—Å–ª–µ –æ–±–º–µ–Ω–∞: {arr}")
                swapped = True
            else:
                print(f"    {arr[j]} <= {arr[j+1]}, –Ω–µ –º–µ–Ω—è–µ–º")
        
        print(f"  –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ—Ö–æ–¥–∞ {i + 1}: {arr}")
        
        if not swapped:
            print(f"  –ù–µ –±—ã–ª–æ –æ–±–º–µ–Ω–æ–≤ - –º–∞—Å—Å–∏–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!")
            break
    
    print(f"\n–ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {arr}")
    print(f"–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π: {step}")
    return arr


# ============================================================================
# –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø
# ============================================================================

def demonstrate_bubble_sort():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞
    """
    print("=" * 60)
    print("BUBBLE SORT - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è")
    print("=" * 60)
    
    # –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
    test_arr1 = [64, 34, 25, 12, 22, 11, 90]
    print(f"\n–¢–µ—Å—Ç 1: {test_arr1}")
    result1 = bubble_sort(test_arr1)
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {result1}")
    
    # –¢–µ—Å—Ç 2: –£–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
    test_arr2 = [1, 2, 3, 4, 5]
    print(f"\n–¢–µ—Å—Ç 2 (—É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω): {test_arr2}")
    result2 = bubble_sort(test_arr2)
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {result2}")
    
    # –¢–µ—Å—Ç 3: –û–±—Ä–∞—Ç–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
    test_arr3 = [5, 4, 3, 2, 1]
    print(f"\n–¢–µ—Å—Ç 3 (–æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫): {test_arr3}")
    result3 = bubble_sort(test_arr3)
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {result3}")
    
    # –¢–µ—Å—Ç 4: –ú–∞—Å—Å–∏–≤ —Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏
    test_arr4 = [3, 1, 4, 1, 5, 9, 2, 6, 5]
    print(f"\n–¢–µ—Å—Ç 4 (—Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏): {test_arr4}")
    result4 = bubble_sort(test_arr4)
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {result4}")
    
    # –ü–æ—à–∞–≥–æ–≤–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ
    print("\n" + "=" * 60)
    print("–ü–û–®–ê–ì–û–í–û–ï –ò–°–ü–û–õ–ù–ï–ù–ò–ï –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ [5, 2, 8, 1, 9]")
    print("=" * 60)
    bubble_sort_with_steps([5, 2, 8, 1, 9])


# ============================================================================
# –°–†–ê–í–ù–ï–ù–ò–ï –° –î–†–£–ì–ò–ú–ò –ê–õ–ì–û–†–ò–¢–ú–ê–ú–ò
# ============================================================================

def compare_with_builtin():
    """
    –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
    """
    import time
    import random
    
    print("\n" + "=" * 60)
    print("–°–†–ê–í–ù–ï–ù–ò–ï –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò")
    print("=" * 60)
    
    sizes = [100, 500, 1000]
    
    for size in sizes:
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤
        arr = [random.randint(1, 1000) for _ in range(size)]
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º Bubble Sort
        start = time.time()
        bubble_result = bubble_sort(arr)
        bubble_time = time.time() - start
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
        start = time.time()
        builtin_result = sorted(arr)
        builtin_time = time.time() - start
        
        print(f"–†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞: {size}")
        print(f"  Bubble Sort: {bubble_time*1000:.2f}ms")
        print(f"  Built-in:    {builtin_time*1000:.2f}ms")
        print(f"  –†–∞–∑–Ω–∏—Ü–∞:     {bubble_time/builtin_time:.1f}x –º–µ–¥–ª–µ–Ω–Ω–µ–µ")
        print()


if __name__ == "__main__":
    demonstrate_bubble_sort()
    compare_with_builtin()
